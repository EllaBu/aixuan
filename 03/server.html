<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <link rel="stylesheet" href="./css/server.css">
</head>
<body>
<div class="nav">
  <ul>
    <li><a href="index.html">首页</a></li>
    <li class="active"><a href="server.html">服务详情</a></li>
  </ul>
</div>
<div class="header">
  <h3>服务调用信息</h3>
  <ul class="server clearfix">
    <li><i>响应时间：</i><span>410ms</span></li>
    <li><i>持续时间：</i><span>413ms</span></li>
    <li><i>pan总数：</i><span>S2</span></li>
    <li><i>深度：</i><span>2</span></li>
    <li><i>服务数：</i><span>2</span></li>
    <li><i>涉及IP：</i><span>1</span></li>
    <li><i>节点数：</i><span>1</span></li>
    <li><i>应用数：</i><span>1</span></li>
    <li><i>失败数：</i><span>0</span></li>
    <li><i>慢服务：</i><span>0</span></li>
  </ul>
  <ul class="choose">
    <li><label for="">APP汇总：</label><input type="checkbox" onclick="showSummary(this, 'app_summary')"></li>
    <li><label for="">NODE汇总：</label><input type="checkbox" onclick="showSummary(this, 'node_summary')"></li>
    <li><label for="">IP汇总：</label><input type="checkbox" onclick="showSummary(this, 'ip_summary')"></li>
  </ul>
  <div class="selected">
    <p id="app_summary"><span>tangyuan2-demo *2</span></p>
    <p id="node_summary"><span>*2</span></p>
    <p id="ip_summary"><span>192.168.50.245 *2</span></p>
  </div>
</div>
<div class="content">
  <h3>服务调用明细</h3>
  <table id="treeTable1" class="server-table" style="width: 1566px;">
    <tr>
      <td style="width: 556px;">标题</td>
      <td class="server-title">
        <p class="server-style">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          <span></span>
        </p>
        <p class="server-tip">
          <b>82.600ms</b>
          <b>165.200ms</b>
          <b>247.800ms</b>
          <b>330.400ms</b>
          <b>413.000ms</b>
          <b>495.600ms</b>
        </p>
      </td>
    </tr>
    <tr id="1">
      <td><span controller="true">ts/m3</span></td>
      <td class="server-detail">
        <p class="server-style">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          <span></span>
        </p>
        <div class="server-state">
          <p style="width: 900px;">900ms</p>
        </div>
        <table class="server-list">

          <tr>
            <td>服务</td>
            <td>ts/m3</td>
          </tr>
          <tr>
            <td>请求参数</td>
            <td>
              <xmp autoHeight="true" readonly><?xml version="1.0" encoding="UTF-8"?>
                <X>
                <I K="x" V="2222"/>
              </X></xmp>
              <!--<xmp><?xml version="1.0" encoding="UTF-8"?>-->
              <!--<X>-->
              <!--<I K="x" V="2222"/>-->
              <!--</X>-->
              <!--</xmp>-->
            </td>
          </tr>
          <tr>
            <td>返回结果</td>
            <td>
              <xmp autoHeight="true" readonly>ddd<?xml version="1.0" encoding="UTF-8"?>
                <X>
                <I K="x" V="2222"/>
              </X></xmp>
            </td>
          </tr>
          <tr>
            <td>code</td>
            <td>
              <span class="server-code success-code">333</span>
            </td>
          </tr>
          <tr>
            <td>MESSAGE</td>
            <td>ts/m3</td>
          </tr>
          <tr>
            <td>请求过程</td>
            <td class="process">
              <a class="fold" href="javascript:;"></a>
              <p>有4条记录隐藏</p>
              <ul>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
              </ul>
            </td>
          </tr>
        </table>
      </td>
    </tr>
    <tr id="2" pId="1">
      <td><span controller="true">2</span></td>
      <td class="server-detail">
        <p class="server-style">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          <span></span>
        </p>
        <div class="server-state">
          <p style="width: 700px;margin-left: 20px;">700ms</p>
        </div>
        <table class="server-list">

          <tr>
            <td>服务</td>
            <td>ts/m3</td>
          </tr>
          <tr>
            <td>请求参数</td>
            <td>
              <xmp readonly><?xml version="1.0" encoding="UTF-8"?>
                <X>
                <I K="x" V="2222"/>
              </X></xmp>
            </td>
          </tr>
          <tr>
            <td>返回结果</td>
            <td>
              <xmp readonly><?xml version="1.0" encoding="UTF-8"?>
                <X>
                <I K="x" V="2222"/>
              </X></xmp>
            </td>
          </tr>
          <tr>
            <td>code</td>
            <td>
              <span class="server-code success-code">333</span>
            </td>
          </tr>
          <tr>
            <td>MESSAGE</td>
            <td>ts/m3</td>
          </tr>
          <tr>
            <td>请求过程</td>
            <td class="process">
              <a class="fold" href="javascript:;"></a>
              <p>有4条记录隐藏</p>
              <ul>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
              </ul>
            </td>
          </tr>
        </table>
      </td>
    </tr>
    <tr id="3" pId="2">
      <td>3</td>
      <td class="server-detail">
        <p class="server-style">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          <span></span>
        </p>
        <div class="error-state">
          <p>请求出错</p>
        </div>
        <table class="server-list">

          <tr>
            <td>服务</td>
            <td>ts/m3</td>
          </tr>
          <tr>
            <td>请求参数</td>
            <td>
              <xmp readonly><?xml version="1.0" encoding="UTF-8"?>
                <X>
                <I K="x" V="2222"/>
              </X></xmp>
            </td>
          </tr>
          <tr>
            <td>返回结果</td>
            <td>
              <xmp readonly><?xml version="1.0" encoding="UTF-8"?>
                <X>
                <I K="x" V="2222"/>
              </X></xmp>
            </td>
          </tr>
          <tr>
            <td>code</td>
            <td>
              <span class="server-code error-code">222</span>
            </td>
          </tr>
          <tr>
            <td>MESSAGE</td>
            <td>ts/m3</td>
          </tr>
          <tr>
            <td>请求过程</td>
            <td class="process">
              <a class="fold" href="javascript:;"></a>
              <p>有4条记录隐藏</p>
              <ul>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
              </ul>
            </td>
          </tr>
        </table>
      </td>
    </tr>
    <tr id="4" pId="2">
      <td>4</td>
      <td class="server-detail">
        <p class="server-style">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          <span></span>
        </p>
        <div class="server-state">
          <p style="width: 600px;margin-left: 50px;">600ms</p>
        </div>
        <table class="server-list">
          <tr>
            <td>code</td>
            <td>333</td>
          </tr>
          <tr>
            <td>服务</td>
            <td>ts/m3</td>
          </tr>
          <tr>
            <td>请求参数</td>
            <td>
              <xmp readonly><?xml version="1.0" encoding="UTF-8"?>
                <X>
                <I K="x" V="2222"/>
              </X></xmp>
            </td>
          </tr>
          <tr>
            <td>返回结果</td>
            <td>
              <xmp readonly><?xml version="1.0" encoding="UTF-8"?>
                <X>
                <I K="x" V="2222"/>
              </X></xmp>
            </td>
          </tr>
          <tr>
            <td>MESSAGE</td>
            <td>ts/m3</td>
          </tr>
          <tr>
            <td>请求过程</td>
            <td class="process">
              <a class="fold" href="javascript:;"></a>
              <p>有4条记录隐藏</p>
              <ul>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
              </ul>
            </td>
          </tr>
        </table>
      </td>
    </tr>
    <tr id="5" pId="4">
      <td>4.1</td>

      <td class="server-detail">
        <p class="server-style">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          <span></span>
        </p>
        <div class="error-state">
          <p>请求超时</p>
        </div>
        <table class="server-list">
          <tr>
            <td>code</td>
            <td>333</td>
          </tr>
          <tr>
            <td>服务</td>
            <td>ts/m3</td>
          </tr>
          <tr>
            <td>请求参数</td>
            <td>
              <xmp readonly><?xml version="1.0" encoding="UTF-8"?>
                <X>
                <I K="x" V="2222"/>
              </X></xmp>
            </td>
          </tr>
          <tr>
            <td>返回结果</td>
            <td>
              <xmp readonly><?xml version="1.0" encoding="UTF-8"?>
                <X>
                <I K="x" V="2222"/>
              </X></xmp>
            </td>
          </tr>
          <tr>
            <td>MESSAGE</td>
            <td>ts/m3</td>
          </tr>
          <tr>
            <td>请求过程</td>
            <td class="process">
              <a class="fold" href="javascript:;"></a>
              <p>有4条记录隐藏</p>
              <ul>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
              </ul>
            </td>
          </tr>
        </table>
      </td>
    </tr>

    <tr id="6">
      <td>8</td>
      <td class="server-detail">
        <p class="server-style">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          <span></span>
        </p>
        <div class="error-state">
          <p>请求出错</p>
        </div>
        <table class="server-list">
          <tr>
            <td>code</td>
            <td>333</td>
          </tr>
          <tr>
            <td>服务</td>
            <td>ts/m3</td>
          </tr>
          <tr>
            <td>请求参数</td>
            <td>
              <xmp readonly><?xml version="1.0" encoding="UTF-8"?>
                <X>
                <I K="x" V="2222"/>
              </X></xmp>
            </td>
          </tr>
          <tr>
            <td>返回结果</td>
            <td>
              <xmp readonly><?xml version="1.0" encoding="UTF-8"?>
                <X>
                <I K="x" V="2222"/>
              </X></xmp>
            </td>
          </tr>
          <tr>
            <td>MESSAGE</td>
            <td>ts/m3</td>
          </tr>
          <tr>
            <td>请求过程</td>
            <td class="process">
              <a class="fold" href="javascript:;"></a>
              <p>有4条记录隐藏</p>
              <ul>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
                <li>
                  <xmp name="" id="">第一条记录<X>
                    <I K="x" V="2222"/>
                  </X></xmp>
                </li>
              </ul>
            </td>
          </tr>
        </table>
      </td>
    </tr>
    <!--<tr id="7" hasChild = "true">
      <td>7</td>
      <td>注意这个节点是动态加载的</td>
    </tr>-->
  </table>
</div>
<script src="./js/jquery-2.2.4.min.js"></script>
<script src="./js/jquery.treeTable.js"></script>
<script>
  $(function () {
      /*$.each($("textarea"), function(i, n){
        $(n).css("height", n.scrollHeight + "px");
      })*/

      function readyNumber() {
        $('textarea').each(function () {
          this.setAttribute('style', 'height:' + (this.scrollHeight) + 'px;overflow-y:hidden;');
        }).on('input', function () {
          this.style.height = 'auto';
          this.style.height = (this.scrollHeight) + 'px';
        })
      }

      // textarea 自适应高度
      function makeExpandingArea(el) {
        var setStyle = function (el) {
          el.style.height = 'auto';
          el.style.height = el.scrollHeight + 'px';
          // console.log(el.scrollHeight);
        }
        var delayedResize = function (el) {
          window.setTimeout(function () {
            setStyle(el)
          }, 0);
        }
        if (el.addEventListener) {
          el.addEventListener('input', function () {
            setStyle(el)
          }, false);
          setStyle(el)
        } else if (el.attachEvent) {
          el.attachEvent('onpropertychange', function () {
            setStyle(el)
          });
          setStyle(el)
        }
        if (window.VBArray && window.addEventListener) { //IE9
          el.attachEvent("onkeydown", function () {
            var key = window.event.keyCode;
            if (key == 8 || key == 46) delayedResize(el);
          });
          el.attachEvent("oncut", function () {
            delayedResize(el);
          }); //处理粘贴
        }
      }

      makeExpandingArea($('textarea'));


      var option = {
        theme: 'vsStyle',
        expandLevel: 3,
        // beforeExpand: function ($treeTable, id) {
        //   //判断id是否已经有了孩子节点，如果有了就不再加载，这样就可以起到缓存的作用
        //   if ($('.' + id, $treeTable).length) {
        //     return;
        //   }
        //   //这里的html可以是ajax请求
        //   var html = '<tr id="8" pId="7"><td>7.1</td><td>可以是ajax请求来的内容</td></tr>'
        //     + '<tr id="9" pId="7"><td>7.2</td><td>动态的内容</td></tr>';
        //
        //   $treeTable.addChilds(html);
        // },
        // onSelect: function ($treeTable, id) {
        //   window.console && console.log('onSelect:' + id);
        //
        // }

      };
      $('#treeTable1').treeTable(option);

      $('.server-style').bind('click', function () {
        $(this).parents('tr').siblings().find('.server-list').slideUp(1);
        $(this).siblings('.server-list').slideToggle(300);
      })

      $('a.fold').bind('click', function () {
        $(this).toggleClass('active');
        $(this).parents('.process').toggleClass('list-fold')
      })


    }
  );

  function showSummary(o, id) {
    if (o.checked) {
      document.getElementById(id).style.display = 'block';
    } else {
      document.getElementById(id).style.display = 'none';
    }
  }
</script>
</body>
</html>